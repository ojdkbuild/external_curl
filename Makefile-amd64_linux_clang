
export CC := ${CMAKE_C_COMPILER}
export CFLAGS := ${${PROJECT_NAME}_CFLAGS}

all:
ifeq ($(wildcard ${CMAKE_CURRENT_BINARY_DIR}/curl),)
	echo ${CMAKE_CURRENT_BINARY_DIR}
	cp -a ${CMAKE_CURRENT_LIST_DIR}/curl ${CMAKE_CURRENT_BINARY_DIR}/curl
	cd ${CMAKE_CURRENT_BINARY_DIR}/curl && $(SH) ./buildconf
	cd ${CMAKE_CURRENT_BINARY_DIR}/curl && $(SH) ./configure \
	    --enable-static \
	    --enable-symbol-hiding \
	    --enable-http \
	    --enable-ipv6 \
	    --enable-cookies \
	    --without-zlib \
	    --without-ssl \
	    --disable-shared \
	    --disable-ares \
	    --disable-dependency-tracking \
	    --disable-fast-install \
	    --disable-ftp \
	    --disable-file \
	    --disable-ldap \
	    --disable-ldaps \
	    --disable-rtsp \
	    --disable-proxy \
	    --disable-dict \
	    --disable-telnet \
	    --disable-tftp \
	    --disable-pop3 \
	    --disable-imap \
	    --disable-smb \
	    --disable-smtp \
	    --disable-gopher \
	    --disable-manual \
	    --disable-libcurl-option \
	    --disable-versioned-symbols \
	    --disable-threaded-resolver \
	    --disable-sspi \
	    --disable-ntlm-wb \
	    --disable-unix-sockets \
	    --disable-soname-bump \
	    --without-winssl \
	    --without-winssl \
	    --without-darwinssl \
	    --without-gnutls \
	    --without-polarssl \
	    --without-cyassl \
	    --without-nss \
	    --without-axtls \
	    --without-libmetalink \
	    --without-libssh2 \
	    --without-librtmp \
	    --without-winidn \
	    --without-libidn \
	    --without-nghttp2 \
	    ${${PROJECT_NAME}_DEBUG}
	cd ${CMAKE_CURRENT_BINARY_DIR}/curl && $(MAKE)
	cp ${CMAKE_CURRENT_BINARY_DIR}/curl/lib/.libs/libcurl.a ${CMAKE_CURRENT_BINARY_DIR}
else
	@echo "[${CMAKE_CURRENT_BINARY_DIR}/curl] directory found, skipping build"
endif	
